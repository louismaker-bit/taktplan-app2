<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Taktplan</title>

<style>
/* ---------- iOS Overscroll FIX ---------- */
html, body{
  overscroll-behavior: none;
  height: 100%;
}

/* ---------- Theme Variables ---------- */
:root{
  --bg:#0b0c10;
  --card:rgba(255,255,255,.06);
  --card2:rgba(255,255,255,.08);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.62);
  --border:rgba(255,255,255,.14);
  --accent:#7dd3fc;
  --ok:rgba(34,197,94,.16);
  --err:rgba(239,68,68,.18);
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --radius:16px;
  --tap:48px;
  --sans:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
}

@media (prefers-color-scheme: light){
  :root{
    --bg:#f6f7fb;
    --card:rgba(255,255,255,.92);
    --card2:rgba(255,255,255,.98);
    --text:rgba(10,12,16,.92);
    --muted:rgba(10,12,16,.62);
    --border:rgba(10,12,16,.12);
    --accent:#0284c7;
    --ok:rgba(34,197,94,.14);
    --err:rgba(239,68,68,.12);
    --shadow:0 10px 30px rgba(0,0,0,.10);
  }
}

/* ---------- Base ---------- */
body{
  margin:0;
  font-family:var(--sans);
  background:var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
}

body.force-dark{ background:#0b0c10; }
body.force-light{ background:#f6f7fb; }

.wrap{ max-width:820px; margin:0 auto; padding:14px; padding-top:88px; }

/* ---------- Topbar ---------- */
.topbar{
  position:fixed; inset:0 0 auto 0;
  padding:12px 14px calc(12px + env(safe-area-inset-top));
  backdrop-filter:blur(14px);
  background:rgba(0,0,0,.35);
  border-bottom:1px solid var(--border);
  z-index:50;
}

.topbar-inner{
  max-width:820px;
  margin:0 auto;
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
}

.title{ font-weight:900; }
.sub{ font-size:12px; color:var(--muted); }
.grow{ flex:1; }

.seg{
  display:flex;
  border:1px solid var(--border);
  border-radius:999px;
  overflow:hidden;
  background:var(--card);
  box-shadow:var(--shadow);
}

.seg button{
  height:36px;
  min-width:60px;
  border:0;
  background:none;
  color:var(--muted);
  padding:0 10px;
  font-weight:800;
}

.seg button.active{
  color:var(--text);
  background:rgba(125,211,252,.18);
}

/* ---------- Cards ---------- */
.card{
  background:var(--card2);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:14px;
  margin-top:12px;
  box-shadow:var(--shadow);
}

.grid2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
@media(max-width:540px){ .grid2{ grid-template-columns:1fr; } }

label{ font-weight:900; display:block; margin:10px 0 6px; }
textarea, select, input{
  width:100%;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  padding:12px;
  font-size:16px;
}

textarea{ min-height:120px; resize:vertical; }

button.btn{
  height:var(--tap);
  border-radius:14px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.08);
  color:var(--text);
  font-weight:900;
}

button.primary{
  background:rgba(125,211,252,.22);
  border-color:rgba(125,211,252,.35);
}

button:active{ transform:translateY(1px); }

.small{ font-size:12px; color:var(--muted); }

.result.ok{ background:var(--ok); }
.result.err{ background:var(--err); }

.favbar{ display:flex; gap:8px; flex-wrap:wrap; }
.favbar button{
  height:40px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--card);
  font-weight:900;
}

.hide{ display:none!important; }

/* ---------- Compact Mode ---------- */
body.compact .small,
body.compact .storageCard,
body.compact .planSaveCard{ display:none!important; }
body.compact .wrap{ padding-top:84px; }
</style>
</head>

<body>

<div class="topbar">
  <div class="topbar-inner">
    <div>
      <div class="title">Taktplan</div>
      <div class="sub">Offline · Heute/Jetzt · Favoriten</div>
    </div>
    <div class="grow"></div>

    <div class="seg">
      <button id="themeAuto" class="active">Auto</button>
      <button id="themeDark">Dark</button>
      <button id="themeLight">Light</button>
    </div>

    <div class="seg">
      <button id="modeFull" class="active">Full</button>
      <button id="modeCompact">Kompakt</button>
    </div>

    <div class="seg">
      <button id="haptOn" class="active">Haptik</button>
      <button id="haptOff">Aus</button>
    </div>
  </div>
</div>

<div class="wrap">

  <div class="card">
    <label>Heute / Jetzt</label>
    <button class="btn primary" id="nowBtn">Heute + aktuelle Runde</button>
    <div class="small" id="nowHint"></div>
  </div>

  <div class="card">
    <label>Plan einfügen</label>
    <textarea id="table" placeholder="1 Airbag LISA 2 Bepl. Re. BESETZT ..."></textarea>
    <button class="btn" id="applyBtn">Plan anwenden</button>
  </div>

  <div class="card">
    <label>Mitarbeiter</label>
    <select id="employee" disabled></select>
    <div class="favbar" id="favbar"></div>

    <label>Tag</label>
    <select id="day" disabled>
      <option value="mo">Mo</option><option value="di">Di</option><option value="mi">Mi</option>
      <option value="do">Do</option><option value="fr">Fr</option>
    </select>

    <label>Runde</label>
    <select id="round" disabled>
      <option>1</option><option>2</option><option>3</option><option>4</option>
    </select>

    <button class="btn primary" id="queryBtn" disabled>Abfrage</button>
  </div>

  <div id="result" class="card hide"></div>

</div>

<script>
/* ---------- Minimal JS (stabil & ruhig) ---------- */
const UI_KEY="ui_v1";
const HAPT_ON=()=>navigator.vibrate && navigator.vibrate(10);

const themeAuto=document.getElementById("themeAuto");
const themeDark=document.getElementById("themeDark");
const themeLight=document.getElementById("themeLight");
const modeFull=document.getElementById("modeFull");
const modeCompact=document.getElementById("modeCompact");
const haptOn=document.getElementById("haptOn");
const haptOff=document.getElementById("haptOff");

function setTheme(t){
  document.body.classList.remove("force-dark","force-light");
  if(t==="dark") document.body.classList.add("force-dark");
  if(t==="light") document.body.classList.add("force-light");
  localStorage.setItem(UI_KEY,JSON.stringify({theme:t}));
}

themeAuto.onclick=()=>{HAPT_ON();setTheme("auto");};
themeDark.onclick=()=>{HAPT_ON();setTheme("dark");};
themeLight.onclick=()=>{HAPT_ON();setTheme("light");};

modeCompact.onclick=()=>{HAPT_ON();document.body.classList.add("compact");};
modeFull.onclick=()=>{HAPT_ON();document.body.classList.remove("compact");};

haptOff.onclick=()=>localStorage.setItem("hapt","0");
haptOn.onclick=()=>localStorage.setItem("hapt","1");

document.getElementById("nowBtn").onclick=()=>HAPT_ON();
document.getElementById("applyBtn").onclick=()=>HAPT_ON();
document.getElementById("queryBtn").onclick=()=>HAPT_ON();
</script>

</body>
</html>
